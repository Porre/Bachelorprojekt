\chapter{Elliptiske kurver}
I dette kapitel vil vi introducere elliptiske kurver.
Det viser sig, at være muligt at påføre de elliptiske kurver en gruppestruktur ved en geometrisk addition af punkter fra en sådan kurve. Vi vil indføre denne additionslov og vise, at det resulterer i en abelsk gruppe. For at kunne gøre dette skal vi desuden anvende projektiv geometri, som også vil blive introduceret.

\section{Elliptiske kurver}
Det er muligt at definere elliptiske kurver på flere måder. Lad $K$ være et legeme, da er følgende defintion tilstrækkelig til vores formål:

\begin{definition}
En elliptisk kurve $E$ er grafen for en ligning
\begin{align}
	\label{elliptic_curve}
	y^2 = x^3 + Ax + B,
\end{align}
hvor $A, B \in K$ er konstanter og $4A^3 + 27B^2 \neq 0$. 
\end{definition}

Vi siger, at den elliptiske kurve $E$ er på Weierstrass normalform, når den kan beskrives som i \eqref{elliptic_curve}. Hvis $\cha (K) \neq 2, 3$ er det faktisk altid muligt, at omskrive en elliptisk kurve til Weierstrass normalform (se eksempelvis kapitel 2 i \cite{Washington}). Det kan vises, at diskriminanten for \eqref{elliptic_curve} er \begin{align*}
	\Delta = 4A^3 + 27B^2,
\end{align*}
så en elliptisk kurve kan ikke have multiple rødder pr. kravet i definitionen. I figur \ref{figure_elliptic_curves} ses to eksempler på elliptiske kurver over de reelle tal.
\begin{figure}
\label{figure_elliptic_curves}
\centering
\includegraphics[scale=0.2]{elliptic_1}
\includegraphics[scale=0.2]{elliptic_2}
\caption{Eksempler på elliptiske kurver over $\mathbb{R}$. Venstre: $y^2 = x^3 - x$, Højre: $y^2 = x^3 -x + 1$}
\end{figure}
Definitionen siger, at $A, B$ skal tilhøre et legeme $K$. Det kunne være $\mathbb{R}, \mathbb{C}$ eller $\mathbb{Q}$. I denne opgave vil vi dog fokusere på de endelige legemer $\mathbb{F}_p = \mathbb{Z}/p\mathbb{Z}$ hvor $p$ er et primtal, eller de endelige legemer $\mathbb{F}_q$ hvor $q = p^r$ for $r \geq 1$. Hvis $A, B \in K$ for en elliptisk kurve $E$ siger vi, at $E$ er givet over $K$. Vi vil fra nu af med $E$ mene en elliptisk kurve på Weierstrass normalform og med $K$ mene et legeme medmindre andet er nævnt. Punkterne på en elliptisk kurve med koordinater i et legeme $L \supseteq K$ skriver vi som $E(L)$, hvor 
\begin{align}
\label{elliptic_curve_points}
	E(L) = \{ \infty \} \cup \{ (x, y) \in L \times L \mid y^2 = x^3 + Ax + B \}.
\end{align}
Punktet $\infty$ kaldes punktet i uendelig og viser sig nødvendigt for at $E(L)$ bliver en gruppe under additionen vi vi introducere i næste afsnit. Intuitivt kan vi se $\infty$ som værende punktet $(\infty, \infty)$ som er placeret i toppen af $y$-aksen. En linje siges at gå igennem $\infty$ præcist, når den er lodret. To lodrette linjer skærer derfor hinanden i $\infty$. $\infty$ kan også tænkes som værende i bunden af $y$-aksen, men så vil to lodrette linjer skære hinanden to steder, hvilket er hvorfor vi kræver at $\infty$ i toppen og i bunden er et og samme punkt.


\section{Det projektive plan}
Som tidligere nævnt vil vi etablere en gruppestruktur på de elliptiske
kurver. For at kunne gøre dette får vi brug for det projektive plan 
$\mathbb{P}^2$. Rent intuitivt kan man se det projektive plan, som
værende den affine plan 
\begin{align*}
	\mathbb{A}^2(K) = \{ (x, y) \in K \times K \},
\end{align*}
hvor $K$ et et legeme, med en ekstra linje "i uendelig". 
Vi ønsker at formalisere dette begreb. 
For $x, y, z \in K$ ikke alle nul og $\lambda \in K$, $\lambda \neq 0$, 
definerer vi en ækvivalensrelation. To tripler $(x_1, y_1, z_1)$ og 
$(x_2, y_2, z_2)$ siges at være ækvivalente hvis 
\begin{align*}
	(x_1, y_1, z_1) = (\lambda x_2, \lambda y_2, \lambda z_2),
\end{align*}
og vi skriver $(x_1, y_1, z_1) \sim (x_2, y_2, z_2)$. Vi vil fremover skrive
$(x:y:z)$ for en sådan ækvivalensklasse. I de tilfælde hvor $z \neq 0$ har vi, at
\begin{align*}
	(x, y, z) = (x/z, y/z, 1),
\end{align*}
hvilket er de punkter vi kalder for de "endelige" punkter i $\mathbb{P}^2(K)$.
Vi er nemlig i stand til at associere et punkt fra $\mathbb{A}^2(K)$ med et sådan
punkt. Vi har en afbildning (en inklusion for at være mere præcis) 
$\mathbb{A}^2(K) \to \mathbb{P}^2(K)$ givet ved
\begin{align*}
	(x, y) \mapsto (x : y : 1).
\end{align*}
Dette kan vi selvfølgelig ikke gøre, når $z=0$ og vi ser det som at vi
har $\infty$ i enten $x$- eller $y$-koordinaten. Vi kalder dermed punkterne
$(x, y, 0)$ for punkterne i "uendelig".
Hvis vi nu homogenisere ligningen for en elliptisk kurve $E$ med variablen $z$ får vi, at
\begin{align}
\label{homogeniseret_weierstrass}
	y^2 z = x^3 + Ax z^2 + B z^3.
\end{align} 
Indsætter vi $z=0$ i \eqref{homogeniseret_weierstrass} får vi, at $0 = x^3$ hvilket har en tredobbelt rod i $x=0$. Linjen i uendelig skærer altså $E$ tre gange i det samme punkt. Punktet der opfylder dette er punktet $(0 : 1 : 0)$. Vi får en ny afbildning
\begin{align*}
	(x, y) \mapsto (x : 1 : z),
\end{align*}
hvor $(0, 0) \mapsto (0 : 1 : 0)$, som er punktet vi kalder $\infty$.





\section{Gruppeloven}
Lad $E$ være en elliptisk kurve over $K$. Det viser sig, at vi kan tage to punkter (eller blot ét) på $E$ og producere et tredje punkt som også er på $E$. Vi vil i dette afsnit vise, hvordan dette gøres og til slut konkludere, at defineres dette som en addition operator bliver $E(K)$ en additiv abelsk gruppe. Vælg to punkter
\begin{align*}
	P_1 = (x_1, y_1) \quad \text{og} \quad P_2 = (x_2, y_2)
\end{align*}
på $E$. 
\begin{figure}
\label{figure_addition_law}
\centering
\includegraphics[scale=0.25]{elliptic_3}
\caption{Addition af to punkter på en elliptisk kurve}
\end{figure}
Vi kan da trække en ret linje $L$ igennem punkterne $P_1$ og $P_2$, som så vil skære kurven for $E$ i et tredje punkt ${P_3}'$ (se appendiks for bevis om skæring i 3 punkter). Vi definerer $P_1 + P_2 = P_3$ til at være reflektionen i $x$-aksen af dette punkt. 

Vi vil nu udlede formlerne for denne addition af punkter på $E$. Antag først, at $P_1 \neq P_2$ og lad $P_1$ og $P_2$ være forskellige fra $\infty$. Vi har da, at hældningen for linjen der går igennem $P_1$ og $P_2$ er
\begin{align*}
	m = \frac{y_2 - y_1}{x_2 - x_1}.
\end{align*}
Hvis $x_1 = x_2$ er linjen lodret, hvilket er et tilfælde som vi behandler senere. Antag altså at $x_1 \neq x_2$, da har vi at
\begin{align*}
	y_2 = m(x_2 - x_1) + y_1.
\end{align*}
Vi indsætter dette i ligningen for $E$ og får, at 
\begin{align*}
	(m(x-x_1) + y_1)^2 = x^3 + Ax + B.
\end{align*}
Skrives dette ud får vi, at
\begin{align*}
	0 &= x^3 + Ax + B - 2y_1 m(x-x_1) - m^2 (x - x_1)^2 - y_{1}^{2} \\
	&= x^3 + Ax + B - 2y_1 m x - 2y_1 m x_1 - m^2 (x^2 -2x x_1 + x_{1}^{2}) - y_{1}^{2} \\
	&= x^3 - m^2 x^2 + (A-2my_1 +2m^2x_1)x -2m y_1 x_1 -m^2 x_{1}^{2} - y_{1}^{2} + B. 
\end{align*}
Denne har tre rødder, som netop er de tre punkter, hvor $L$ skærer $E$.
Pr. vores konstruktion kender vi allerede de to rødder $x_1$ og $x_2$,
og vi ønsker at finde den tredje. Generelt for et kubisk polynomium 
$x^3 + ax^2 + bx + c$, med rødder $r, s, t$, har vi at 
\begin{align*}
	x^3 + ax^2 + bx + c = (x - r)(x - s)(x - t) = x^3 - (r + s + t)x^2 + \ldots,
\end{align*}
hvilket giver os, at $-a = r + s + t$. Hvis de to rødder vi kender er $r$ og $s$
kan vi finde den sidste som
\begin{align*}
	t = -a - r - s.
\end{align*}
I vores tilfælde er $a=-m^2$ så vi har, at 
\begin{align*}
	x = m^2 - x_1 - x_2.
\end{align*}
Vi mangler da blot at reflektere dette punkt for at have fundet punktet 
punktet $P_1 + P_2 = P_3 = (x, y)$. Vi reflekterer over $x$-aksen og finder, at 
\begin{align*}
	x = m^2 - x_1 - x_2, \quad y = m(x_1 - x) - y_1.
\end{align*}
Vi vender nu tilbage til tilfældet, hvor $x_1 = x_2$. Da vil linjen igennem 
$P_1$ og $P_2$ være lodret, så den skærer $E$ i $\infty$. Vi husker, at når $\infty$ 
reflekteres over $x$-aksen får vi igen $\infty$. Vi får altså, at $P_1 + P_2=\infty$.

Tilfældet hvor $P_1 = P_2 = (x_1, y_1)$ kræver lidt flere overvejelser. For to punkter som ligger
tæt på hinanden vil linjen igennem punkterne nærme sig tangenten til et af punkterne. Når vi har to ens punkter lader vi da linjen igennem dem være tangenten til punktet. Ved implicit differentiation finder vi, at 
\begin{align*}
	2y \frac{dy}{dx} = 3x^2 + A, \quad \text{så} \quad m = \frac{dy}{dx} = \frac{3x_{1}^{2} + A}{2y_1}.
\end{align*}
Hvis $y_1 = 0$ er linjen og i det tilfælde lader vi $P_1 + P_2 = \infty$. Antag altså, at $y_1 \neq 0$. Ligningen for $L$ er 
\begin{align*}
	y = m(x-x_1) + y_1,
\end{align*}
som før. Vi får den kubiske ligning
\begin{align*}
	0 = x^3 - m^2 x^2 + \ldots
\end{align*}
Vi kender dog kun én rod denne gang $x_1$, men den er en dobbelt rod idet at $L$ er tangent til $E$ i $P_1$. Så på samme måde som før får vi, at 
\begin{align*}
	x_3 = m^2 - 2x_1, \quad y_3 = m(x_1 - x_3) - y_1.
\end{align*}
Antag nu, at $P_2 = \infty$. Linjen som går igennem $P_1$ og $\infty$ er en lodret linje, som skærer $E$ i reflektionen af $P_1$ over $x$-aksen. Når vi reflekterer dette punkt igen over $x$-aksen får vi igen $P_1$. Altså har vi, at
\begin{align*}
	P_1 + \infty = P_1.
\end{align*}
Vi udvider dette sådan, at vi også har at $\infty + \infty = \infty$. 
\\
Det er nu mere klart, hvorfor elliptiske kurver og denne definition for en addition passer sammen. Højresiden i en ligning på Weierstrass normalform er kubisk så en linje igennem to punkter skærer den i et tredje punkt. At venstresiden er $y^2$ sikrer os, at kurven er symmetrisk om $x$-aksen, som benyttes når vi vi reflekterer et punkt. Vi opsummerer denne diskussion og kan opstille gruppeloven:

\begin{definition}[Gruppeloven]
Lad $E$ være en elliptisk kurve. Givet to punkter, $P_1, P_2 \in E(K)$, $P_i = (x_i, y_i)$
Givet to punkter $P_1, P_2 \in E(K)$, $P_i = (x_i, y_i)$. Et tredje punkt
$P_3 = P_1 + P_2 = (x_3, y_3)$ findes da som følger
\begin{enumerate}
	\item Hvis $x_1 \neq x_2$ er 
	\begin{align*}
		x_3 = m^2 - x_1 - x_2, \quad y_3 = m(x_1 - x_3) - y_1,
	\end{align*}		
	hvor $m = (y_2 - y_1)/(x_2 - x_1)$.
	\item Hvis $x_1 = x_2$, men $y_1 \neq y_2$ da er $P_1 + P_2 = \infty$.
	\item Hvis $P_1 = P_2$ og $y_1 \neq 0$ er 
	\begin{align*}
		x_3 = m^2 - 2x_1, \quad y_3=m(x_1 - x_3) - y_1,
	\end{align*}
	hvor $m=(3{x_1}^2 + A)/2y_1$.
	\item Hvis $P_1 = P_2$ og $y_1 = 0$ da er $P_1 + P_2 = \infty$.
\end{enumerate}
Vi definerer desuden, at 
\begin{align*}
	P + \infty = \infty,
\end{align*}
for alle $P \in E(K)$.
\end{definition}

Det måske overraskende hovedresultatet i dette kapitel er, at denne addition resulterer i en abelsk gruppe:

\begin{theorem}
Punkterne på $E$, altså $E(K)$, udgør en additiv abelsk gruppe hvor $\infty$ er identiteten og additionen er som defineret i gruppeloven. 
\end{theorem}
\begin{proof}
For at være en gruppe skal additionen af punkter være kommutativ, der skal eksistere en identitet, der skal eksistere en invers til hvert element og additionen af punkter skal være associativ.

Kommutativiteten kan enten ses direkte fra formlerne eller fra det faktum, at linjen igennem $P_1$ og $P_2$ er den samme som linjen igennem $P_2$ og $P_1$. At $\infty$ er identiteten følger pr. definitionen af denne. For de inverse elementer lader vi $P'$ være reflektionen af $P$, da er $P+P' = \infty$. Associativiteten kan vises direkte ud fra formlerne, men der er mange tilfælde der skal behandles, hvilket gør det besværligt. Der forefindes et bevis for dette i \cite{Washington}.
\end{proof}